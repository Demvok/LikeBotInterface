<header>
    <h2>Створення нового завдання</h2>
    <app-task-stepper (stageChange)="onStageChange($event)"></app-task-stepper>
</header>
<main>
    <form [formGroup]="taskForm" (ngSubmit)="onSubmit()" class="task-form">
        <!-- First Column: Task Name, Action Type, and Action Details -->
        <div class="first-column">
            <div class="form-group">
                <label for="taskName">Task Name *</label>
                <input 
                    id="taskName"
                    type="text" 
                    formControlName="name" 
                    placeholder="Enter task name"
                    [class.error]="taskForm.get('name')?.invalid && taskForm.get('name')?.touched">
                <div class="error-message" *ngIf="taskForm.get('name')?.invalid && taskForm.get('name')?.touched">
                    Task name is required
                </div>
            </div>

            <div class="form-group">
                <label>Action Type *</label>
                <div class="radio-group">
                    <label class="radio-option">
                        <input 
                            type="radio" 
                            formControlName="actionType" 
                            value="react">
                        <span class="radio-custom"></span>
                        React
                    </label>
                    <label class="radio-option">
                        <input 
                            type="radio" 
                            formControlName="actionType" 
                            value="comment">
                        <span class="radio-custom"></span>
                        Comment
                    </label>
                </div>
                <div class="error-message" *ngIf="taskForm.get('actionType')?.invalid && taskForm.get('actionType')?.touched">
                    Please select an action type
                </div>
            </div>

            <div class="form-group" *ngIf="actionType === 'react'">
                <label for="palette">Reaction Palette *</label>
                <select id="palette" formControlName="palette" class="select-field" [disabled]="loadingPalettes">
                    <option value="">{{ loadingPalettes ? 'Loading palettes...' : 'Select palette' }}</option>
                    <option *ngFor="let palette of palettes" [value]="palette.palette_name">
                        {{ palette.palette_name }}
                    </option>
                </select>
                <div class="error-message" *ngIf="actionType === 'react' && taskForm.get('palette')?.invalid && taskForm.get('palette')?.touched">
                    Please select a reaction palette
                </div>
            </div>

            <div class="form-group" *ngIf="actionType === 'comment'">
                <label for="commentContent">Comment Content *</label>
                <textarea 
                    id="commentContent"
                    formControlName="commentContent" 
                    placeholder="Enter comment content"
                    rows="4"
                    [class.error]="actionType === 'comment' && taskForm.get('commentContent')?.invalid && taskForm.get('commentContent')?.touched"></textarea>
                <div class="error-message" *ngIf="actionType === 'comment' && taskForm.get('commentContent')?.invalid && taskForm.get('commentContent')?.touched">
                    Comment content is required
                </div>
            </div>
        </div>

        <!-- Second Column: Description -->
        <div class="second-column">
            <div class="form-group">
                <label for="taskDescription">Description</label>
                <textarea 
                    id="taskDescription"
                    formControlName="description" 
                    placeholder="Enter task description (optional)"
                    rows="3"></textarea>
            </div>
        </div>
        
        <!-- Button moved inside form -->
        <div class="button-group">
            <button 
                type="button" 
                class="btn btn-primary" 
                [disabled]="!canProceed()"
                (click)="proceedToNext()">
                Next Step
            </button>
        </div>
    </form>
</main>
<footer>
</footer>