<div class="app-layout">
  <!-- Sidebar (hidden on login/register pages) -->
   <aside class="sidebar" *ngIf="showSidebar">
    <div class="sidebar-content">
      <div class="sidebar-title">
        <a routerLink="/home" routerLinkActive="active"><h2>Menu</h2></a>
        <hr>
      </div>

      <div class="sidebar-nav-container">
        <!-- Main Navigation Category -->
        <div class="category">
          <button class="category-toggle" (click)="toggleCategory('main')">
            <span>–û—Å–Ω–æ–≤–Ω–µ</span>
            <span class="toggle-icon" [class.expanded]="expandedCategories['main']">‚ñº</span>
          </button>
          
          <nav class="sidebar-nav" *ngIf="expandedCategories['main']">
            <a routerLink="/tasks" routerLinkActive="active"><div class="sidebar-nav-item">–ó–∞–≤–¥–∞–Ω–Ω—è</div></a>
            <a routerLink="/palette" routerLinkActive="active"><div class="sidebar-nav-item">–ü–∞–ª—ñ—Ç—Ä–∏ —Ä–µ–∞–∫—Ü—ñ–π</div></a>
            <a routerLink="/accounts" routerLinkActive="active"><div class="sidebar-nav-item">–ê–∫–∞—É–Ω—Ç–∏</div></a>
            <a routerLink="/posts" routerLinkActive="active"><div class="sidebar-nav-item">–í—Å—ñ –ø–æ—Å—Ç–∏</div></a>
            <a routerLink="/channels" routerLinkActive="active"><div class="sidebar-nav-item">–ö–∞–Ω–∞–ª–∏</div></a>
            <a routerLink="/logs" routerLinkActive="active"><div class="sidebar-nav-item">–õ–æ–≥–∏</div></a>
          </nav>
        </div>

        <!-- Admin Category -->
        <div class="category" *ngIf="isAdmin()">
          <button class="category-toggle" (click)="toggleCategory('admin')">
            <span>–ê–¥–º—ñ–Ω—ñ—Å—Ç—Ä–∞—Ü—ñ—è</span>
            <span class="toggle-icon" [class.expanded]="expandedCategories['admin']">‚ñº</span>
          </button>
          
          <nav class="sidebar-nav" *ngIf="expandedCategories['admin']">
            <a routerLink="/users" routerLinkActive="active"><div class="sidebar-nav-item">üë• –ö–æ—Ä–∏—Å—Ç—É–≤–∞—á—ñ</div></a>
            <a routerLink="/proxies" routerLinkActive="active"><div class="sidebar-nav-item">üîå Proxies</div></a>
            <a routerLink="/settings" routerLinkActive="active"><div class="sidebar-nav-item">üîê –ö–æ–Ω—Ñ—ñ–≥—É—Ä–∞—Ü—ñ—è</div></a>
          </nav>
        </div>

        <!-- Task Detailed Category -->
        <div class="category" *ngIf="is_task_detailed">
          <button class="category-toggle" (click)="toggleCategory('detailed')">
            <span>–î–µ—Ç–∞–ª—ñ –∑–∞–≤–¥–∞–Ω–Ω—è</span>
            <span class="toggle-icon" [class.expanded]="expandedCategories['detailed']">‚ñº</span>
          </button>
          
          <nav class="sidebar-nav-detailed" *ngIf="expandedCategories['detailed']">
            <a [routerLink]="'/task/' + task_id" routerLinkActive="active"><div class="sidebar-nav-item">–û–≥–ª—è–¥</div></a>
            <a [routerLink]="'/task/' + task_id + '/accounts'" routerLinkActive="active"><div class="sidebar-nav-item">–ê–∫–∞—É–Ω—Ç–∏</div></a>
            <a [routerLink]="'/task/' + task_id + '/posts'" routerLinkActive="active"><div class="sidebar-nav-item">–ü–æ—Å—Ç–∏</div></a>
            <a [routerLink]="'/task/' + task_id + '/report'" routerLinkActive="active"><div class="sidebar-nav-item">–ó–≤—ñ—Ç</div></a>
          </nav>
        </div>
      </div>

      <!-- User info and logout -->
      <div class="sidebar-footer">
        <div class="theme-toggle">
          <button class="theme-btn" (click)="toggleTheme()" [title]="isDarkTheme ? 'Switch to Light Mode' : 'Switch to Dark Mode'">
            {{ isDarkTheme ? '‚òÄÔ∏è' : 'üåô' }}
          </button>
        </div>
        <div class="user-info" *ngIf="currentUser">
          <div class="user-details">
            <div class="username">{{ currentUser.username }}</div>
            <div class="user-role">{{ currentUser.role }}</div>
          </div>
        </div>
        <hr>
        <button class="logout-button" (click)="logout()">–í–∏–π—Ç–∏</button>
      </div>

    </div>
    
   </aside>

   <!-- Content -->
    <main class="content" [class.full-width]="!showSidebar">
      <router-outlet></router-outlet>     
    </main>

</div>